#!/usr/bin/env ruby

module Music
  
  class BeatCrossSimilarityMatrix
    attr_accessor :width, :height
  
    def initialize(beat_array1, beat_array2)
      while beat_array1.length < beat_array2.length
        beat_array1.push nil
      end
      while beat_array2.length < beat_array1.length
        beat_array2.push nil
      end

      @width = beat_array1.size
      @matrix = []
      (0..(beat_array1.size-1)).each do |x|
        @matrix[x] = []
        (0..x).each do |y|
          if beat_array1[x].nil?
            @matrix[x][y] = 0.0
          else
            @matrix[x][y] = beat_array1[x].similarity_to beat_array2[y] 
          end
        end
      end
    end
  
    def val(x,y)
      return val(y, x) if x < y
      return @matrix[x][y]
    end
   
    def arithmetic_mean_of_diag(i) # FIXME: the other one should be renamed to geometric mean...
      x = i
      y = 0
      sum = 0.0
      count = 0
      while x < @width
        sum += val(x, y)
        x += 1
        y += 1
        count += 1
      end
      return sum / count.to_f
    end

    def mean_of_diag(i)
      x = i
      y = 0
      prod = 1.0
      while x < @width
        prod = prod * (1.0 + val(x, y))
        x += 1
        y += 1
      end
      return prod
    end

    def max_arithmetic_mean_of_diag
      data = (0..(@width-1)).map{ |i| arithmetic_mean_of_diag(i) }
      return data.max
    end

    def max_mean_of_diag
      data = (0..(@width-1)).map{ |i| mean_of_diag(i) }
      return data.max
    end
  
    def autocorrel_of_main_diag(len)
      correls = [0.0]*len
      (0..(@width-1)).each do |i|
        correls[len - 1 - ((len -1 + i) % len)] += @matrix[i][i]
      end
      return correls
    end
  end

  class BeatSimilarityMatrix < BeatCrossSimilarityMatrix

    def initialize(beat_array)
      super(beat_array, beat_array)
    end
  
    def save(filename, expected, meter_idx, offset_idx)
      f = File.new("html/"+filename+".html", "w")
      f.puts "<html>"
      f.puts "<body>"
  
      f.puts "expected: #{expected}<br />"  
  
      meter = save_meter_candidates(f, meter_idx)
      save_offset_candidates(f, meter, offset_idx)
      save_similarity_matrix(f)
  
      f.puts "</body>"
      f.puts "</html>"
      f.close
    end
  
  private
  
    def save_meter_candidates(f, marker_idx)
      data = (1..20).map{ |i| mean_of_diag(i) }
      m = data.max
      data.map!{|x| x / m }
      data.map!{|x| (x*80.0).round }
      f.puts "<br/>"
      f.puts "<img style='border: 1px solid #a0a0a0;' src=\"https://chart.googleapis.com/chart?cht=ls&chd=s:underp&chm=N,000000,0,-1,11|s,3399CC,0,#{marker_idx-1}.0,11.0&chxt=x&chxr=0,1,20,1&chd=t:#{data.join(',')}&chs=500x200\">"
      f.puts "<br/>"
  
      return (1..20).map{ |i| {:offset=>i,:score=>mean_of_diag(i) } }.sort{|x,y| y[:score]<=>x[:score]}[1][:offset]
    end
  
    def save_offset_candidates(f, meter, marker_idx)
      scores = [0.0]*meter
      (0..(@width-1)).each do |i|
        #scores[            (i % meter)] += @matrix[i][i]
        scores[meter - 1 - ((meter -1 + i) % meter)] += @matrix[i][i]
      end
      m = scores.max
      scores.map!{|x| 80.0*x/m }
      puts "scores: #{scores}"
  
      f.puts "<br/>"
      f.puts "<img style='border: 1px solid #a0a0a0;' src=\"https://chart.googleapis.com/chart?cht=lc&chxt=x&chxr=0,0,#{meter-1},1&chd=s:underp&chm=N,000000,0,-1,11|s,3399CC,0,#{marker_idx}.0,11.0&chd=t:#{scores.join(',')}&chs=500x200\">"
      f.puts "<br/>"
    end
  
    def save_similarity_matrix(f)
      f.puts "<table cellspacing=\"0\" cellpadding=\"0\" style='padding:0;margin:0;border:0;'>"
      (0..(@width-1)).each do |x|
        f.puts "<tr style='padding:0;margin:0;border:0;'>"
        (0..(@width-1)).each do |y|
          f.puts "<td style=\"border:0;width:4px;height:4px;background:#{val_to_color(val(x,y))};\">"
          f.puts "</td>"
        end
        f.puts "</tr>"
      end
      f.puts "</table>"
    end
  
    def val_to_color(v) # v in [0, 1]; returns something like '#f0f0f0'
      return $html_spectrum[(v*Float($html_spectrum.length-1.0)).round]
    end
  end
  
end

# FIXME: This is terrible 

$html_spectrum = []

$html_spectrum.unshift "#ff0000"
$html_spectrum.unshift "#ff0000"
$html_spectrum.unshift "#ff0100"
$html_spectrum.unshift "#ff0200"
$html_spectrum.unshift "#ff0300"
$html_spectrum.unshift "#ff0400"
$html_spectrum.unshift "#ff0500"
$html_spectrum.unshift "#ff0600"
$html_spectrum.unshift "#ff0700"
$html_spectrum.unshift "#ff0800"
$html_spectrum.unshift "#ff0900"
$html_spectrum.unshift "#ff0a00"
$html_spectrum.unshift "#ff0b00"
$html_spectrum.unshift "#ff0c00"
$html_spectrum.unshift "#ff0e00"
$html_spectrum.unshift "#ff0f00"
$html_spectrum.unshift "#ff1000"
$html_spectrum.unshift "#ff1100"
$html_spectrum.unshift "#ff1200"
$html_spectrum.unshift "#ff1300"
$html_spectrum.unshift "#ff1400"
$html_spectrum.unshift "#ff1500"
$html_spectrum.unshift "#ff1600"
$html_spectrum.unshift "#ff1700"
$html_spectrum.unshift "#ff1800"
$html_spectrum.unshift "#ff1900"
$html_spectrum.unshift "#ff1a00"
$html_spectrum.unshift "#ff1b00"
$html_spectrum.unshift "#ff1c00"
$html_spectrum.unshift "#ff1e00"
$html_spectrum.unshift "#ff1f00"
$html_spectrum.unshift "#ff2000"
$html_spectrum.unshift "#ff2100"
$html_spectrum.unshift "#ff2200"
$html_spectrum.unshift "#ff2300"
$html_spectrum.unshift "#ff2400"
$html_spectrum.unshift "#ff2500"
$html_spectrum.unshift "#ff2600"
$html_spectrum.unshift "#ff2700"
$html_spectrum.unshift "#ff2800"
$html_spectrum.unshift "#ff2900"
$html_spectrum.unshift "#ff2a00"
$html_spectrum.unshift "#ff2b00"
$html_spectrum.unshift "#ff2c00"
$html_spectrum.unshift "#ff2e00"
$html_spectrum.unshift "#ff2f00"
$html_spectrum.unshift "#ff3000"
$html_spectrum.unshift "#ff3100"
$html_spectrum.unshift "#ff3200"
$html_spectrum.unshift "#ff3300"
$html_spectrum.unshift "#ff3400"
$html_spectrum.unshift "#ff3500"
$html_spectrum.unshift "#ff3600"
$html_spectrum.unshift "#ff3700"
$html_spectrum.unshift "#ff3800"
$html_spectrum.unshift "#ff3900"
$html_spectrum.unshift "#ff3a00"
$html_spectrum.unshift "#ff3b00"
$html_spectrum.unshift "#ff3c00"
$html_spectrum.unshift "#ff3e00"
$html_spectrum.unshift "#ff3f00"
$html_spectrum.unshift "#ff4000"
$html_spectrum.unshift "#ff4100"
$html_spectrum.unshift "#ff4200"
$html_spectrum.unshift "#ff4300"
$html_spectrum.unshift "#ff4400"
$html_spectrum.unshift "#ff4500"
$html_spectrum.unshift "#ff4600"
$html_spectrum.unshift "#ff4700"
$html_spectrum.unshift "#ff4800"
$html_spectrum.unshift "#ff4900"
$html_spectrum.unshift "#ff4a00"
$html_spectrum.unshift "#ff4b00"
$html_spectrum.unshift "#ff4c00"
$html_spectrum.unshift "#ff4e00"
$html_spectrum.unshift "#ff4f00"
$html_spectrum.unshift "#ff5000"
$html_spectrum.unshift "#ff5100"
$html_spectrum.unshift "#ff5200"
$html_spectrum.unshift "#ff5300"
$html_spectrum.unshift "#ff5400"
$html_spectrum.unshift "#ff5500"
$html_spectrum.unshift "#ff5600"
$html_spectrum.unshift "#ff5700"
$html_spectrum.unshift "#ff5800"
$html_spectrum.unshift "#ff5900"
$html_spectrum.unshift "#ff5a00"
$html_spectrum.unshift "#ff5b00"
$html_spectrum.unshift "#ff5c00"
$html_spectrum.unshift "#ff5e00"
$html_spectrum.unshift "#ff5f00"
$html_spectrum.unshift "#ff6000"
$html_spectrum.unshift "#ff6100"
$html_spectrum.unshift "#ff6200"
$html_spectrum.unshift "#ff6300"
$html_spectrum.unshift "#ff6400"
$html_spectrum.unshift "#ff6500"
$html_spectrum.unshift "#ff6600"
$html_spectrum.unshift "#ff6700"
$html_spectrum.unshift "#ff6800"
$html_spectrum.unshift "#ff6900"
$html_spectrum.unshift "#ff6a00"
$html_spectrum.unshift "#ff6b00"
$html_spectrum.unshift "#ff6c00"
$html_spectrum.unshift "#ff6e00"
$html_spectrum.unshift "#ff6f00"
$html_spectrum.unshift "#ff7000"
$html_spectrum.unshift "#ff7100"
$html_spectrum.unshift "#ff7200"
$html_spectrum.unshift "#ff7300"
$html_spectrum.unshift "#ff7400"
$html_spectrum.unshift "#ff7500"
$html_spectrum.unshift "#ff7600"
$html_spectrum.unshift "#ff7700"
$html_spectrum.unshift "#ff7800"
$html_spectrum.unshift "#ff7900"
$html_spectrum.unshift "#ff7a00"
$html_spectrum.unshift "#ff7b00"
$html_spectrum.unshift "#ff7c00"
$html_spectrum.unshift "#ff7e00"
$html_spectrum.unshift "#ff7f00"
$html_spectrum.unshift "#ff8000"
$html_spectrum.unshift "#ff8100"
$html_spectrum.unshift "#ff8200"
$html_spectrum.unshift "#ff8300"
$html_spectrum.unshift "#ff8400"
$html_spectrum.unshift "#ff8500"
$html_spectrum.unshift "#ff8600"
$html_spectrum.unshift "#ff8700"
$html_spectrum.unshift "#ff8800"
$html_spectrum.unshift "#ff8900"
$html_spectrum.unshift "#ff8a00"
$html_spectrum.unshift "#ff8b00"
$html_spectrum.unshift "#ff8c00"
$html_spectrum.unshift "#ff8e00"
$html_spectrum.unshift "#ff8f00"
$html_spectrum.unshift "#ff9000"
$html_spectrum.unshift "#ff9100"
$html_spectrum.unshift "#ff9200"
$html_spectrum.unshift "#ff9300"
$html_spectrum.unshift "#ff9400"
$html_spectrum.unshift "#ff9500"
$html_spectrum.unshift "#ff9600"
$html_spectrum.unshift "#ff9700"
$html_spectrum.unshift "#ff9800"
$html_spectrum.unshift "#ff9900"
$html_spectrum.unshift "#ff9a00"
$html_spectrum.unshift "#ff9b00"
$html_spectrum.unshift "#ff9c00"
$html_spectrum.unshift "#ff9e00"
$html_spectrum.unshift "#ff9f00"
$html_spectrum.unshift "#ffa000"
$html_spectrum.unshift "#ffa100"
$html_spectrum.unshift "#ffa200"
$html_spectrum.unshift "#ffa300"
$html_spectrum.unshift "#ffa400"
$html_spectrum.unshift "#ffa500"
$html_spectrum.unshift "#ffa600"
$html_spectrum.unshift "#ffa700"
$html_spectrum.unshift "#ffa800"
$html_spectrum.unshift "#ffa900"
$html_spectrum.unshift "#ffaa00"
$html_spectrum.unshift "#ffab00"
$html_spectrum.unshift "#ffac00"
$html_spectrum.unshift "#ffae00"
$html_spectrum.unshift "#ffaf00"
$html_spectrum.unshift "#ffb000"
$html_spectrum.unshift "#ffb100"
$html_spectrum.unshift "#ffb200"
$html_spectrum.unshift "#ffb300"
$html_spectrum.unshift "#ffb400"
$html_spectrum.unshift "#ffb500"
$html_spectrum.unshift "#ffb600"
$html_spectrum.unshift "#ffb700"
$html_spectrum.unshift "#ffb800"
$html_spectrum.unshift "#ffb900"
$html_spectrum.unshift "#ffba00"
$html_spectrum.unshift "#ffbb00"
$html_spectrum.unshift "#ffbc00"
$html_spectrum.unshift "#ffbe00"
$html_spectrum.unshift "#ffbf00"
$html_spectrum.unshift "#ffc000"
$html_spectrum.unshift "#ffc100"
$html_spectrum.unshift "#ffc200"
$html_spectrum.unshift "#ffc300"
$html_spectrum.unshift "#ffc400"
$html_spectrum.unshift "#ffc500"
$html_spectrum.unshift "#ffc600"
$html_spectrum.unshift "#ffc700"
$html_spectrum.unshift "#ffc800"
$html_spectrum.unshift "#ffc900"
$html_spectrum.unshift "#ffca00"
$html_spectrum.unshift "#ffcb00"
$html_spectrum.unshift "#ffcc00"
$html_spectrum.unshift "#ffce00"
$html_spectrum.unshift "#ffcf00"
$html_spectrum.unshift "#ffe000"
$html_spectrum.unshift "#ffe100"
$html_spectrum.unshift "#ffe200"
$html_spectrum.unshift "#ffe300"
$html_spectrum.unshift "#ffe400"
$html_spectrum.unshift "#ffe500"
$html_spectrum.unshift "#ffe600"
$html_spectrum.unshift "#ffe700"
$html_spectrum.unshift "#ffe800"
$html_spectrum.unshift "#ffe900"
$html_spectrum.unshift "#ffea00"
$html_spectrum.unshift "#ffeb00"
$html_spectrum.unshift "#ffec00"
$html_spectrum.unshift "#ffee00"
$html_spectrum.unshift "#ffef00"
$html_spectrum.unshift "#fff000"
$html_spectrum.unshift "#fff100"
$html_spectrum.unshift "#fff200"
$html_spectrum.unshift "#fff300"
$html_spectrum.unshift "#fff400"
$html_spectrum.unshift "#fff500"
$html_spectrum.unshift "#fff600"
$html_spectrum.unshift "#fff700"
$html_spectrum.unshift "#fff800"
$html_spectrum.unshift "#fff900"
$html_spectrum.unshift "#fffa00"
$html_spectrum.unshift "#fffb00"
$html_spectrum.unshift "#fffc00"
$html_spectrum.unshift "#fffe00"
$html_spectrum.unshift "#ffff00"
$html_spectrum.unshift "#feff00"
$html_spectrum.unshift "#fcff00"
$html_spectrum.unshift "#fbff00"
$html_spectrum.unshift "#faff00"
$html_spectrum.unshift "#f9ff00"
$html_spectrum.unshift "#f8ff00"
$html_spectrum.unshift "#f7ff00"
$html_spectrum.unshift "#f6ff00"
$html_spectrum.unshift "#f5ff00"
$html_spectrum.unshift "#f4ff00"
$html_spectrum.unshift "#f3ff00"
$html_spectrum.unshift "#f2ff00"
$html_spectrum.unshift "#f1ff00"
$html_spectrum.unshift "#f0ff00"
$html_spectrum.unshift "#efff00"
$html_spectrum.unshift "#eeff00"
$html_spectrum.unshift "#ecff00"
$html_spectrum.unshift "#ebff00"
$html_spectrum.unshift "#eaff00"
$html_spectrum.unshift "#e9ff00"
$html_spectrum.unshift "#e8ff00"
$html_spectrum.unshift "#e7ff00"
$html_spectrum.unshift "#e6ff00"
$html_spectrum.unshift "#e5ff00"
$html_spectrum.unshift "#e4ff00"
$html_spectrum.unshift "#e3ff00"
$html_spectrum.unshift "#e2ff00"
$html_spectrum.unshift "#e1ff00"
$html_spectrum.unshift "#e0ff00"
$html_spectrum.unshift "#cfff00"
$html_spectrum.unshift "#ceff00"
$html_spectrum.unshift "#ccff00"
$html_spectrum.unshift "#cbff00"
$html_spectrum.unshift "#caff00"
$html_spectrum.unshift "#c9ff00"
$html_spectrum.unshift "#c8ff00"
$html_spectrum.unshift "#c7ff00"
$html_spectrum.unshift "#c6ff00"
$html_spectrum.unshift "#c5ff00"
$html_spectrum.unshift "#c4ff00"
$html_spectrum.unshift "#c3ff00"
$html_spectrum.unshift "#c2ff00"
$html_spectrum.unshift "#c1ff00"
$html_spectrum.unshift "#c0ff00"
$html_spectrum.unshift "#bfff00"
$html_spectrum.unshift "#beff00"
$html_spectrum.unshift "#bcff00"
$html_spectrum.unshift "#bbff00"
$html_spectrum.unshift "#baff00"
$html_spectrum.unshift "#b9ff00"
$html_spectrum.unshift "#b8ff00"
$html_spectrum.unshift "#b7ff00"
$html_spectrum.unshift "#b6ff00"
$html_spectrum.unshift "#b5ff00"
$html_spectrum.unshift "#b4ff00"
$html_spectrum.unshift "#b3ff00"
$html_spectrum.unshift "#b2ff00"
$html_spectrum.unshift "#b1ff00"
$html_spectrum.unshift "#b0ff00"
$html_spectrum.unshift "#afff00"
$html_spectrum.unshift "#aeff00"
$html_spectrum.unshift "#acff00"
$html_spectrum.unshift "#abff00"
$html_spectrum.unshift "#aaff00"
$html_spectrum.unshift "#a9ff00"
$html_spectrum.unshift "#a8ff00"
$html_spectrum.unshift "#a7ff00"
$html_spectrum.unshift "#a6ff00"
$html_spectrum.unshift "#a5ff00"
$html_spectrum.unshift "#a4ff00"
$html_spectrum.unshift "#a3ff00"
$html_spectrum.unshift "#a2ff00"
$html_spectrum.unshift "#a1ff00"
$html_spectrum.unshift "#a0ff00"
$html_spectrum.unshift "#9fff00"
$html_spectrum.unshift "#9eff00"
$html_spectrum.unshift "#9cff00"
$html_spectrum.unshift "#9bff00"
$html_spectrum.unshift "#9aff00"
$html_spectrum.unshift "#99ff00"
$html_spectrum.unshift "#98ff00"
$html_spectrum.unshift "#97ff00"
$html_spectrum.unshift "#96ff00"
$html_spectrum.unshift "#95ff00"
$html_spectrum.unshift "#94ff00"
$html_spectrum.unshift "#93ff00"
$html_spectrum.unshift "#92ff00"
$html_spectrum.unshift "#91ff00"
$html_spectrum.unshift "#90ff00"
$html_spectrum.unshift "#8fff00"
$html_spectrum.unshift "#8eff00"
$html_spectrum.unshift "#8cff00"
$html_spectrum.unshift "#8bff00"
$html_spectrum.unshift "#8aff00"
$html_spectrum.unshift "#89ff00"
$html_spectrum.unshift "#88ff00"
$html_spectrum.unshift "#87ff00"
$html_spectrum.unshift "#86ff00"
$html_spectrum.unshift "#85ff00"
$html_spectrum.unshift "#84ff00"
$html_spectrum.unshift "#83ff00"
$html_spectrum.unshift "#82ff00"
$html_spectrum.unshift "#81ff00"
$html_spectrum.unshift "#80ff00"
$html_spectrum.unshift "#7fff00"
$html_spectrum.unshift "#7eff00"
$html_spectrum.unshift "#7cff00"
$html_spectrum.unshift "#7bff00"
$html_spectrum.unshift "#7aff00"
$html_spectrum.unshift "#79ff00"
$html_spectrum.unshift "#78ff00"
$html_spectrum.unshift "#77ff00"
$html_spectrum.unshift "#76ff00"
$html_spectrum.unshift "#75ff00"
$html_spectrum.unshift "#74ff00"
$html_spectrum.unshift "#73ff00"
$html_spectrum.unshift "#72ff00"
$html_spectrum.unshift "#71ff00"
$html_spectrum.unshift "#70ff00"
$html_spectrum.unshift "#6fff00"
$html_spectrum.unshift "#6eff00"
$html_spectrum.unshift "#6cff00"
$html_spectrum.unshift "#6bff00"
$html_spectrum.unshift "#6aff00"
$html_spectrum.unshift "#69ff00"
$html_spectrum.unshift "#68ff00"
$html_spectrum.unshift "#67ff00"
$html_spectrum.unshift "#66ff00"
$html_spectrum.unshift "#65ff00"
$html_spectrum.unshift "#64ff00"
$html_spectrum.unshift "#63ff00"
$html_spectrum.unshift "#62ff00"
$html_spectrum.unshift "#61ff00"
$html_spectrum.unshift "#60ff00"
$html_spectrum.unshift "#5fff00"
$html_spectrum.unshift "#5eff00"
$html_spectrum.unshift "#5cff00"
$html_spectrum.unshift "#5bff00"
$html_spectrum.unshift "#5aff00"
$html_spectrum.unshift "#59ff00"
$html_spectrum.unshift "#58ff00"
$html_spectrum.unshift "#57ff00"
$html_spectrum.unshift "#56ff00"
$html_spectrum.unshift "#55ff00"
$html_spectrum.unshift "#54ff00"
$html_spectrum.unshift "#53ff00"
$html_spectrum.unshift "#52ff00"
$html_spectrum.unshift "#51ff00"
$html_spectrum.unshift "#50ff00"
$html_spectrum.unshift "#4fff00"
$html_spectrum.unshift "#4eff00"
$html_spectrum.unshift "#4cff00"
$html_spectrum.unshift "#4bff00"
$html_spectrum.unshift "#4aff00"
$html_spectrum.unshift "#49ff00"
$html_spectrum.unshift "#48ff00"
$html_spectrum.unshift "#47ff00"
$html_spectrum.unshift "#46ff00"
$html_spectrum.unshift "#45ff00"
$html_spectrum.unshift "#44ff00"
$html_spectrum.unshift "#43ff00"
$html_spectrum.unshift "#42ff00"
$html_spectrum.unshift "#41ff00"
$html_spectrum.unshift "#40ff00"
$html_spectrum.unshift "#3fff00"
$html_spectrum.unshift "#3eff00"
$html_spectrum.unshift "#3cff00"
$html_spectrum.unshift "#3bff00"
$html_spectrum.unshift "#3aff00"
$html_spectrum.unshift "#39ff00"
$html_spectrum.unshift "#38ff00"
$html_spectrum.unshift "#37ff00"
$html_spectrum.unshift "#36ff00"
$html_spectrum.unshift "#35ff00"
$html_spectrum.unshift "#34ff00"
$html_spectrum.unshift "#33ff00"
$html_spectrum.unshift "#32ff00"
$html_spectrum.unshift "#31ff00"
$html_spectrum.unshift "#30ff00"
$html_spectrum.unshift "#2fff00"
$html_spectrum.unshift "#2eff00"
$html_spectrum.unshift "#2cff00"
$html_spectrum.unshift "#2bff00"
$html_spectrum.unshift "#2aff00"
$html_spectrum.unshift "#29ff00"
$html_spectrum.unshift "#28ff00"
$html_spectrum.unshift "#27ff00"
$html_spectrum.unshift "#26ff00"
$html_spectrum.unshift "#25ff00"
$html_spectrum.unshift "#24ff00"
$html_spectrum.unshift "#23ff00"
$html_spectrum.unshift "#22ff00"
$html_spectrum.unshift "#21ff00"
$html_spectrum.unshift "#20ff00"
$html_spectrum.unshift "#1fff00"
$html_spectrum.unshift "#1eff00"
$html_spectrum.unshift "#1cff00"
$html_spectrum.unshift "#1bff00"
$html_spectrum.unshift "#1aff00"
$html_spectrum.unshift "#19ff00"
$html_spectrum.unshift "#18ff00"
$html_spectrum.unshift "#17ff00"
$html_spectrum.unshift "#16ff00"
$html_spectrum.unshift "#15ff00"
$html_spectrum.unshift "#14ff00"
$html_spectrum.unshift "#13ff00"
$html_spectrum.unshift "#12ff00"
$html_spectrum.unshift "#11ff00"
$html_spectrum.unshift "#10ff00"
$html_spectrum.unshift "#0fff00"
$html_spectrum.unshift "#0eff00"
$html_spectrum.unshift "#0cff00"
$html_spectrum.unshift "#0bff00"
$html_spectrum.unshift "#0aff00"
$html_spectrum.unshift "#09ff00"
$html_spectrum.unshift "#08ff00"
$html_spectrum.unshift "#07ff00"
$html_spectrum.unshift "#06ff00"
$html_spectrum.unshift "#05ff00"
$html_spectrum.unshift "#04ff00"
$html_spectrum.unshift "#03ff00"
$html_spectrum.unshift "#02ff00"
$html_spectrum.unshift "#01ff00"
$html_spectrum.unshift "#00ff00"
$html_spectrum.unshift "#00ff01"
$html_spectrum.unshift "#00ff02"
$html_spectrum.unshift "#00ff03"
$html_spectrum.unshift "#00ff04"
$html_spectrum.unshift "#00ff05"
$html_spectrum.unshift "#00ff06"
$html_spectrum.unshift "#00ff07"
$html_spectrum.unshift "#00ff08"
$html_spectrum.unshift "#00ff09"
$html_spectrum.unshift "#00ff0a"
$html_spectrum.unshift "#00ff0b"
$html_spectrum.unshift "#00ff0c"
$html_spectrum.unshift "#00ff0e"
$html_spectrum.unshift "#00ff0f"
$html_spectrum.unshift "#00ff10"
$html_spectrum.unshift "#00ff11"
$html_spectrum.unshift "#00ff12"
$html_spectrum.unshift "#00ff13"
$html_spectrum.unshift "#00ff14"
$html_spectrum.unshift "#00ff15"
$html_spectrum.unshift "#00ff16"
$html_spectrum.unshift "#00ff17"
$html_spectrum.unshift "#00ff18"
$html_spectrum.unshift "#00ff19"
$html_spectrum.unshift "#00ff1a"
$html_spectrum.unshift "#00ff1b"
$html_spectrum.unshift "#00ff1c"
$html_spectrum.unshift "#00ff1e"
$html_spectrum.unshift "#00ff1f"
$html_spectrum.unshift "#00ff20"
$html_spectrum.unshift "#00ff21"
$html_spectrum.unshift "#00ff22"
$html_spectrum.unshift "#00ff23"
$html_spectrum.unshift "#00ff24"
$html_spectrum.unshift "#00ff25"
$html_spectrum.unshift "#00ff26"
$html_spectrum.unshift "#00ff27"
$html_spectrum.unshift "#00ff28"
$html_spectrum.unshift "#00ff29"
$html_spectrum.unshift "#00ff2a"
$html_spectrum.unshift "#00ff2b"
$html_spectrum.unshift "#00ff2c"
$html_spectrum.unshift "#00ff2e"
$html_spectrum.unshift "#00ff2f"
$html_spectrum.unshift "#00ff30"
$html_spectrum.unshift "#00ff31"
$html_spectrum.unshift "#00ff32"
$html_spectrum.unshift "#00ff33"
$html_spectrum.unshift "#00ff34"
$html_spectrum.unshift "#00ff35"
$html_spectrum.unshift "#00ff36"
$html_spectrum.unshift "#00ff37"
$html_spectrum.unshift "#00ff38"
$html_spectrum.unshift "#00ff39"
$html_spectrum.unshift "#00ff3a"
$html_spectrum.unshift "#00ff3b"
$html_spectrum.unshift "#00ff3c"
$html_spectrum.unshift "#00ff3e"
$html_spectrum.unshift "#00ff3f"
$html_spectrum.unshift "#00ff40"
$html_spectrum.unshift "#00ff41"
$html_spectrum.unshift "#00ff42"
$html_spectrum.unshift "#00ff43"
$html_spectrum.unshift "#00ff44"
$html_spectrum.unshift "#00ff45"
$html_spectrum.unshift "#00ff46"
$html_spectrum.unshift "#00ff47"
$html_spectrum.unshift "#00ff48"
$html_spectrum.unshift "#00ff49"
$html_spectrum.unshift "#00ff4a"
$html_spectrum.unshift "#00ff4b"
$html_spectrum.unshift "#00ff4c"
$html_spectrum.unshift "#00ff4e"
$html_spectrum.unshift "#00ff4f"
$html_spectrum.unshift "#00ff50"
$html_spectrum.unshift "#00ff51"
$html_spectrum.unshift "#00ff52"
$html_spectrum.unshift "#00ff53"
$html_spectrum.unshift "#00ff54"
$html_spectrum.unshift "#00ff55"
$html_spectrum.unshift "#00ff56"
$html_spectrum.unshift "#00ff57"
$html_spectrum.unshift "#00ff58"
$html_spectrum.unshift "#00ff59"
$html_spectrum.unshift "#00ff5a"
$html_spectrum.unshift "#00ff5b"
$html_spectrum.unshift "#00ff5c"
$html_spectrum.unshift "#00ff5e"
$html_spectrum.unshift "#00ff5f"
$html_spectrum.unshift "#00ff60"
$html_spectrum.unshift "#00ff61"
$html_spectrum.unshift "#00ff62"
$html_spectrum.unshift "#00ff63"
$html_spectrum.unshift "#00ff64"
$html_spectrum.unshift "#00ff65"
$html_spectrum.unshift "#00ff66"
$html_spectrum.unshift "#00ff67"
$html_spectrum.unshift "#00ff68"
$html_spectrum.unshift "#00ff69"
$html_spectrum.unshift "#00ff6a"
$html_spectrum.unshift "#00ff6b"
$html_spectrum.unshift "#00ff6c"
$html_spectrum.unshift "#00ff6e"
$html_spectrum.unshift "#00ff6f"
$html_spectrum.unshift "#00ff70"
$html_spectrum.unshift "#00ff71"
$html_spectrum.unshift "#00ff72"
$html_spectrum.unshift "#00ff73"
$html_spectrum.unshift "#00ff74"
$html_spectrum.unshift "#00ff75"
$html_spectrum.unshift "#00ff76"
$html_spectrum.unshift "#00ff77"
$html_spectrum.unshift "#00ff78"
$html_spectrum.unshift "#00ff79"
$html_spectrum.unshift "#00ff7a"
$html_spectrum.unshift "#00ff7b"
$html_spectrum.unshift "#00ff7c"
$html_spectrum.unshift "#00ff7e"
$html_spectrum.unshift "#00ff7f"
$html_spectrum.unshift "#00ff80"
$html_spectrum.unshift "#00ff81"
$html_spectrum.unshift "#00ff82"
$html_spectrum.unshift "#00ff83"
$html_spectrum.unshift "#00ff84"
$html_spectrum.unshift "#00ff85"
$html_spectrum.unshift "#00ff86"
$html_spectrum.unshift "#00ff87"
$html_spectrum.unshift "#00ff88"
$html_spectrum.unshift "#00ff89"
$html_spectrum.unshift "#00ff8a"
$html_spectrum.unshift "#00ff8b"
$html_spectrum.unshift "#00ff8c"
$html_spectrum.unshift "#00ff8e"
$html_spectrum.unshift "#00ff8f"
$html_spectrum.unshift "#00ff90"
$html_spectrum.unshift "#00ff91"
$html_spectrum.unshift "#00ff92"
$html_spectrum.unshift "#00ff93"
$html_spectrum.unshift "#00ff94"
$html_spectrum.unshift "#00ff95"
$html_spectrum.unshift "#00ff96"
$html_spectrum.unshift "#00ff97"
$html_spectrum.unshift "#00ff98"
$html_spectrum.unshift "#00ff99"
$html_spectrum.unshift "#00ff9a"
$html_spectrum.unshift "#00ff9b"
$html_spectrum.unshift "#00ff9c"
$html_spectrum.unshift "#00ff9e"
$html_spectrum.unshift "#00ff9f"
$html_spectrum.unshift "#00ffa0"
$html_spectrum.unshift "#00ffa1"
$html_spectrum.unshift "#00ffa2"
$html_spectrum.unshift "#00ffa3"
$html_spectrum.unshift "#00ffa4"
$html_spectrum.unshift "#00ffa5"
$html_spectrum.unshift "#00ffa6"
$html_spectrum.unshift "#00ffa7"
$html_spectrum.unshift "#00ffa8"
$html_spectrum.unshift "#00ffa9"
$html_spectrum.unshift "#00ffaa"
$html_spectrum.unshift "#00ffab"
$html_spectrum.unshift "#00ffac"
$html_spectrum.unshift "#00ffae"
$html_spectrum.unshift "#00ffaf"
$html_spectrum.unshift "#00ffb0"
$html_spectrum.unshift "#00ffb1"
$html_spectrum.unshift "#00ffb2"
$html_spectrum.unshift "#00ffb3"
$html_spectrum.unshift "#00ffb4"
$html_spectrum.unshift "#00ffb5"
$html_spectrum.unshift "#00ffb6"
$html_spectrum.unshift "#00ffb7"
$html_spectrum.unshift "#00ffb8"
$html_spectrum.unshift "#00ffb9"
$html_spectrum.unshift "#00ffba"
$html_spectrum.unshift "#00ffbb"
$html_spectrum.unshift "#00ffbc"
$html_spectrum.unshift "#00ffbe"
$html_spectrum.unshift "#00ffbf"
$html_spectrum.unshift "#00ffc0"
$html_spectrum.unshift "#00ffc1"
$html_spectrum.unshift "#00ffc2"
$html_spectrum.unshift "#00ffc3"
$html_spectrum.unshift "#00ffc4"
$html_spectrum.unshift "#00ffc5"
$html_spectrum.unshift "#00ffc6"
$html_spectrum.unshift "#00ffc7"
$html_spectrum.unshift "#00ffc8"
$html_spectrum.unshift "#00ffc9"
$html_spectrum.unshift "#00ffca"
$html_spectrum.unshift "#00ffcb"
$html_spectrum.unshift "#00ffcc"
$html_spectrum.unshift "#00ffce"
$html_spectrum.unshift "#00ffcf"
$html_spectrum.unshift "#00ffe0"
$html_spectrum.unshift "#00ffe1"
$html_spectrum.unshift "#00ffe2"
$html_spectrum.unshift "#00ffe3"
$html_spectrum.unshift "#00ffe4"
$html_spectrum.unshift "#00ffe5"
$html_spectrum.unshift "#00ffe6"
$html_spectrum.unshift "#00ffe7"
$html_spectrum.unshift "#00ffe8"
$html_spectrum.unshift "#00ffe9"
$html_spectrum.unshift "#00ffea"
$html_spectrum.unshift "#00ffeb"
$html_spectrum.unshift "#00ffec"
$html_spectrum.unshift "#00ffee"
$html_spectrum.unshift "#00ffef"
$html_spectrum.unshift "#00fff0"
$html_spectrum.unshift "#00fff1"
$html_spectrum.unshift "#00fff2"
$html_spectrum.unshift "#00fff3"
$html_spectrum.unshift "#00fff4"
$html_spectrum.unshift "#00fff5"
$html_spectrum.unshift "#00fff6"
$html_spectrum.unshift "#00fff7"
$html_spectrum.unshift "#00fff8"
$html_spectrum.unshift "#00fff9"
$html_spectrum.unshift "#00fffa"
$html_spectrum.unshift "#00fffb"
$html_spectrum.unshift "#00fffc"
$html_spectrum.unshift "#00fffe"
$html_spectrum.unshift "#00ffff"
$html_spectrum.unshift "#00feff"
$html_spectrum.unshift "#00fcff"
$html_spectrum.unshift "#00fbff"
$html_spectrum.unshift "#00faff"
$html_spectrum.unshift "#00f9ff"
$html_spectrum.unshift "#00f8ff"
$html_spectrum.unshift "#00f7ff"
$html_spectrum.unshift "#00f6ff"
$html_spectrum.unshift "#00f5ff"
$html_spectrum.unshift "#00f4ff"
$html_spectrum.unshift "#00f3ff"
$html_spectrum.unshift "#00f2ff"
$html_spectrum.unshift "#00f1ff"
$html_spectrum.unshift "#00f0ff"
$html_spectrum.unshift "#00efff"
$html_spectrum.unshift "#00eeff"
$html_spectrum.unshift "#00ecff"
$html_spectrum.unshift "#00ebff"
$html_spectrum.unshift "#00eaff"
$html_spectrum.unshift "#00e9ff"
$html_spectrum.unshift "#00e8ff"
$html_spectrum.unshift "#00e7ff"
$html_spectrum.unshift "#00e6ff"
$html_spectrum.unshift "#00e5ff"
$html_spectrum.unshift "#00e4ff"
$html_spectrum.unshift "#00e3ff"
$html_spectrum.unshift "#00e2ff"
$html_spectrum.unshift "#00e1ff"
$html_spectrum.unshift "#00e0ff"
$html_spectrum.unshift "#00cfff"
$html_spectrum.unshift "#00ceff"
$html_spectrum.unshift "#00ccff"
$html_spectrum.unshift "#00cbff"
$html_spectrum.unshift "#00caff"
$html_spectrum.unshift "#00c9ff"
$html_spectrum.unshift "#00c8ff"
$html_spectrum.unshift "#00c7ff"
$html_spectrum.unshift "#00c6ff"
$html_spectrum.unshift "#00c5ff"
$html_spectrum.unshift "#00c4ff"
$html_spectrum.unshift "#00c3ff"
$html_spectrum.unshift "#00c2ff"
$html_spectrum.unshift "#00c1ff"
$html_spectrum.unshift "#00c0ff"
$html_spectrum.unshift "#00bfff"
$html_spectrum.unshift "#00beff"
$html_spectrum.unshift "#00bcff"
$html_spectrum.unshift "#00bbff"
$html_spectrum.unshift "#00baff"
$html_spectrum.unshift "#00b9ff"
$html_spectrum.unshift "#00b8ff"
$html_spectrum.unshift "#00b7ff"
$html_spectrum.unshift "#00b6ff"
$html_spectrum.unshift "#00b5ff"
$html_spectrum.unshift "#00b4ff"
$html_spectrum.unshift "#00b3ff"
$html_spectrum.unshift "#00b2ff"
$html_spectrum.unshift "#00b1ff"
$html_spectrum.unshift "#00b0ff"
$html_spectrum.unshift "#00afff"
$html_spectrum.unshift "#00aeff"
$html_spectrum.unshift "#00acff"
$html_spectrum.unshift "#00abff"
$html_spectrum.unshift "#00aaff"
$html_spectrum.unshift "#00a9ff"
$html_spectrum.unshift "#00a8ff"
$html_spectrum.unshift "#00a7ff"
$html_spectrum.unshift "#00a6ff"
$html_spectrum.unshift "#00a5ff"
$html_spectrum.unshift "#00a4ff"
$html_spectrum.unshift "#00a3ff"
$html_spectrum.unshift "#00a2ff"
$html_spectrum.unshift "#00a1ff"
$html_spectrum.unshift "#00a0ff"
$html_spectrum.unshift "#009fff"
$html_spectrum.unshift "#009eff"
$html_spectrum.unshift "#009cff"
$html_spectrum.unshift "#009bff"
$html_spectrum.unshift "#009aff"
$html_spectrum.unshift "#0099ff"
$html_spectrum.unshift "#0098ff"
$html_spectrum.unshift "#0097ff"
$html_spectrum.unshift "#0096ff"
$html_spectrum.unshift "#0095ff"
$html_spectrum.unshift "#0094ff"
$html_spectrum.unshift "#0093ff"
$html_spectrum.unshift "#0092ff"
$html_spectrum.unshift "#0091ff"
$html_spectrum.unshift "#0090ff"
$html_spectrum.unshift "#008fff"
$html_spectrum.unshift "#008eff"
$html_spectrum.unshift "#008cff"
$html_spectrum.unshift "#008bff"
$html_spectrum.unshift "#008aff"
$html_spectrum.unshift "#0089ff"
$html_spectrum.unshift "#0088ff"
$html_spectrum.unshift "#0087ff"
$html_spectrum.unshift "#0086ff"
$html_spectrum.unshift "#0085ff"
$html_spectrum.unshift "#0084ff"
$html_spectrum.unshift "#0083ff"
$html_spectrum.unshift "#0082ff"
$html_spectrum.unshift "#0081ff"
$html_spectrum.unshift "#0080ff"
$html_spectrum.unshift "#007fff"
$html_spectrum.unshift "#007eff"
$html_spectrum.unshift "#007cff"
$html_spectrum.unshift "#007bff"
$html_spectrum.unshift "#007aff"
$html_spectrum.unshift "#0079ff"
$html_spectrum.unshift "#0078ff"
$html_spectrum.unshift "#0077ff"
$html_spectrum.unshift "#0076ff"
$html_spectrum.unshift "#0075ff"
$html_spectrum.unshift "#0074ff"
$html_spectrum.unshift "#0073ff"
$html_spectrum.unshift "#0072ff"
$html_spectrum.unshift "#0071ff"
$html_spectrum.unshift "#0070ff"
$html_spectrum.unshift "#006fff"
$html_spectrum.unshift "#006eff"
$html_spectrum.unshift "#006cff"
$html_spectrum.unshift "#006bff"
$html_spectrum.unshift "#006aff"
$html_spectrum.unshift "#0069ff"
$html_spectrum.unshift "#0068ff"
$html_spectrum.unshift "#0067ff"
$html_spectrum.unshift "#0066ff"
$html_spectrum.unshift "#0065ff"
$html_spectrum.unshift "#0064ff"
$html_spectrum.unshift "#0063ff"
$html_spectrum.unshift "#0062ff"
$html_spectrum.unshift "#0061ff"
$html_spectrum.unshift "#0060ff"
$html_spectrum.unshift "#005fff"
$html_spectrum.unshift "#005eff"
$html_spectrum.unshift "#005cff"
$html_spectrum.unshift "#005bff"
$html_spectrum.unshift "#005aff"
$html_spectrum.unshift "#0059ff"
$html_spectrum.unshift "#0058ff"
$html_spectrum.unshift "#0057ff"
$html_spectrum.unshift "#0056ff"
$html_spectrum.unshift "#0055ff"
$html_spectrum.unshift "#0054ff"
$html_spectrum.unshift "#0053ff"
$html_spectrum.unshift "#0052ff"
$html_spectrum.unshift "#0051ff"
$html_spectrum.unshift "#0050ff"
$html_spectrum.unshift "#004fff"
$html_spectrum.unshift "#004eff"
$html_spectrum.unshift "#004cff"
$html_spectrum.unshift "#004bff"
$html_spectrum.unshift "#004aff"
$html_spectrum.unshift "#0049ff"
$html_spectrum.unshift "#0048ff"
$html_spectrum.unshift "#0047ff"
$html_spectrum.unshift "#0046ff"
$html_spectrum.unshift "#0045ff"
$html_spectrum.unshift "#0044ff"
$html_spectrum.unshift "#0043ff"
$html_spectrum.unshift "#0042ff"
$html_spectrum.unshift "#0041ff"
$html_spectrum.unshift "#0040ff"
$html_spectrum.unshift "#003fff"
$html_spectrum.unshift "#003eff"
$html_spectrum.unshift "#003cff"
$html_spectrum.unshift "#003bff"
$html_spectrum.unshift "#003aff"
$html_spectrum.unshift "#0039ff"
$html_spectrum.unshift "#0038ff"
$html_spectrum.unshift "#0037ff"
$html_spectrum.unshift "#0036ff"
$html_spectrum.unshift "#0035ff"
$html_spectrum.unshift "#0034ff"
$html_spectrum.unshift "#0033ff"
$html_spectrum.unshift "#0032ff"
$html_spectrum.unshift "#0031ff"
$html_spectrum.unshift "#0030ff"
$html_spectrum.unshift "#002fff"
$html_spectrum.unshift "#002eff"
$html_spectrum.unshift "#002cff"
$html_spectrum.unshift "#002bff"
$html_spectrum.unshift "#002aff"
$html_spectrum.unshift "#0029ff"
$html_spectrum.unshift "#0028ff"
$html_spectrum.unshift "#0027ff"
$html_spectrum.unshift "#0026ff"
$html_spectrum.unshift "#0025ff"
$html_spectrum.unshift "#0024ff"
$html_spectrum.unshift "#0023ff"
$html_spectrum.unshift "#0022ff"
$html_spectrum.unshift "#0021ff"
$html_spectrum.unshift "#0020ff"
$html_spectrum.unshift "#001fff"
$html_spectrum.unshift "#001eff"
$html_spectrum.unshift "#001cff"
$html_spectrum.unshift "#001bff"
$html_spectrum.unshift "#001aff"
$html_spectrum.unshift "#0019ff"
$html_spectrum.unshift "#0018ff"
$html_spectrum.unshift "#0017ff"
$html_spectrum.unshift "#0016ff"
$html_spectrum.unshift "#0015ff"
$html_spectrum.unshift "#0014ff"
$html_spectrum.unshift "#0013ff"
$html_spectrum.unshift "#0012ff"
$html_spectrum.unshift "#0011ff"
$html_spectrum.unshift "#0010ff"
$html_spectrum.unshift "#000fff"
$html_spectrum.unshift "#000eff"
$html_spectrum.unshift "#000cff"
$html_spectrum.unshift "#000bff"
$html_spectrum.unshift "#000aff"
$html_spectrum.unshift "#0009ff"
$html_spectrum.unshift "#0008ff"
$html_spectrum.unshift "#0007ff"
$html_spectrum.unshift "#0006ff"
$html_spectrum.unshift "#0005ff"
$html_spectrum.unshift "#0004ff"
$html_spectrum.unshift "#0003ff"
$html_spectrum.unshift "#0002ff"
$html_spectrum.unshift "#0001ff"
$html_spectrum.unshift "#0000ff"
$html_spectrum.unshift "#0000ff"
$html_spectrum.unshift "#0100ff"
$html_spectrum.unshift "#0200ff"
$html_spectrum.unshift "#0300ff"
$html_spectrum.unshift "#0400ff"
$html_spectrum.unshift "#0500ff"
$html_spectrum.unshift "#0600ff"
$html_spectrum.unshift "#0700ff"
$html_spectrum.unshift "#0800ff"
$html_spectrum.unshift "#0900ff"
$html_spectrum.unshift "#0a00ff"
$html_spectrum.unshift "#0b00ff"
$html_spectrum.unshift "#0c00ff"
$html_spectrum.unshift "#0e00ff"
$html_spectrum.unshift "#0f00ff"
$html_spectrum.unshift "#1000ff"
$html_spectrum.unshift "#1100ff"
$html_spectrum.unshift "#1200ff"
$html_spectrum.unshift "#1300ff"
$html_spectrum.unshift "#1400ff"
$html_spectrum.unshift "#1500ff"
$html_spectrum.unshift "#1600ff"
$html_spectrum.unshift "#1700ff"
$html_spectrum.unshift "#1800ff"
$html_spectrum.unshift "#1900ff"
$html_spectrum.unshift "#1a00ff"
$html_spectrum.unshift "#1b00ff"
$html_spectrum.unshift "#1c00ff"
$html_spectrum.unshift "#1e00ff"
$html_spectrum.unshift "#1f00ff"
$html_spectrum.unshift "#2000ff"
$html_spectrum.unshift "#2100ff"
$html_spectrum.unshift "#2200ff"
$html_spectrum.unshift "#2300ff"
$html_spectrum.unshift "#2400ff"
$html_spectrum.unshift "#2500ff"
$html_spectrum.unshift "#2600ff"
$html_spectrum.unshift "#2700ff"
$html_spectrum.unshift "#2800ff"
$html_spectrum.unshift "#2900ff"
$html_spectrum.unshift "#2a00ff"
$html_spectrum.unshift "#2b00ff"
$html_spectrum.unshift "#2c00ff"
$html_spectrum.unshift "#2e00ff"
$html_spectrum.unshift "#2f00ff"
$html_spectrum.unshift "#3000ff"
$html_spectrum.unshift "#3100ff"
$html_spectrum.unshift "#3200ff"
$html_spectrum.unshift "#3300ff"
$html_spectrum.unshift "#3400ff"
$html_spectrum.unshift "#3500ff"
$html_spectrum.unshift "#3600ff"
$html_spectrum.unshift "#3700ff"
$html_spectrum.unshift "#3800ff"
$html_spectrum.unshift "#3900ff"
$html_spectrum.unshift "#3a00ff"
$html_spectrum.unshift "#3b00ff"
$html_spectrum.unshift "#3c00ff"
$html_spectrum.unshift "#3e00ff"
$html_spectrum.unshift "#3f00ff"
$html_spectrum.unshift "#4000ff"
$html_spectrum.unshift "#4100ff"
$html_spectrum.unshift "#4200ff"
$html_spectrum.unshift "#4300ff"
$html_spectrum.unshift "#4400ff"
$html_spectrum.unshift "#4500ff"
$html_spectrum.unshift "#4600ff"
$html_spectrum.unshift "#4700ff"
$html_spectrum.unshift "#4800ff"
$html_spectrum.unshift "#4900ff"
$html_spectrum.unshift "#4a00ff"
$html_spectrum.unshift "#4b00ff"
$html_spectrum.unshift "#4c00ff"
$html_spectrum.unshift "#4e00ff"
$html_spectrum.unshift "#4f00ff"
$html_spectrum.unshift "#5000ff"
$html_spectrum.unshift "#5100ff"
$html_spectrum.unshift "#5200ff"
$html_spectrum.unshift "#5300ff"
$html_spectrum.unshift "#5400ff"
$html_spectrum.unshift "#5500ff"
$html_spectrum.unshift "#5600ff"
$html_spectrum.unshift "#5700ff"
$html_spectrum.unshift "#5800ff"
$html_spectrum.unshift "#5900ff"
$html_spectrum.unshift "#5a00ff"
$html_spectrum.unshift "#5b00ff"
$html_spectrum.unshift "#5c00ff"
$html_spectrum.unshift "#5e00ff"
$html_spectrum.unshift "#5f00ff"
$html_spectrum.unshift "#6000ff"
$html_spectrum.unshift "#6100ff"
$html_spectrum.unshift "#6200ff"
$html_spectrum.unshift "#6300ff"
$html_spectrum.unshift "#6400ff"
$html_spectrum.unshift "#6500ff"
$html_spectrum.unshift "#6600ff"
$html_spectrum.unshift "#6700ff"
$html_spectrum.unshift "#6800ff"
$html_spectrum.unshift "#6900ff"
$html_spectrum.unshift "#6a00ff"
$html_spectrum.unshift "#6b00ff"
$html_spectrum.unshift "#6c00ff"
$html_spectrum.unshift "#6e00ff"
$html_spectrum.unshift "#6f00ff"
$html_spectrum.unshift "#7000ff"
$html_spectrum.unshift "#7100ff"
$html_spectrum.unshift "#7200ff"
$html_spectrum.unshift "#7300ff"
$html_spectrum.unshift "#7400ff"
$html_spectrum.unshift "#7500ff"
$html_spectrum.unshift "#7600ff"
$html_spectrum.unshift "#7700ff"
$html_spectrum.unshift "#7800ff"
$html_spectrum.unshift "#7900ff"
$html_spectrum.unshift "#7a00ff"
$html_spectrum.unshift "#7b00ff"
$html_spectrum.unshift "#7c00ff"
$html_spectrum.unshift "#7e00ff"
$html_spectrum.unshift "#7f00ff"
$html_spectrum.unshift "#8000ff"
$html_spectrum.unshift "#8100ff"
$html_spectrum.unshift "#8200ff"
$html_spectrum.unshift "#8300ff"
$html_spectrum.unshift "#8400ff"
$html_spectrum.unshift "#8500ff"
$html_spectrum.unshift "#8600ff"
$html_spectrum.unshift "#8700ff"
$html_spectrum.unshift "#8800ff"
$html_spectrum.unshift "#8900ff"
$html_spectrum.unshift "#8a00ff"
$html_spectrum.unshift "#8b00ff"
$html_spectrum.unshift "#8c00ff"
$html_spectrum.unshift "#8e00ff"
$html_spectrum.unshift "#8f00ff"
$html_spectrum.unshift "#9000ff"
$html_spectrum.unshift "#9100ff"
$html_spectrum.unshift "#9200ff"
$html_spectrum.unshift "#9300ff"
$html_spectrum.unshift "#9400ff"
$html_spectrum.unshift "#9500ff"
$html_spectrum.unshift "#9600ff"
$html_spectrum.unshift "#9700ff"
$html_spectrum.unshift "#9800ff"
$html_spectrum.unshift "#9900ff"
$html_spectrum.unshift "#9a00ff"
$html_spectrum.unshift "#9b00ff"
$html_spectrum.unshift "#9c00ff"
$html_spectrum.unshift "#9e00ff"
$html_spectrum.unshift "#9f00ff"
$html_spectrum.unshift "#a000ff"
$html_spectrum.unshift "#a100ff"
$html_spectrum.unshift "#a200ff"
$html_spectrum.unshift "#a300ff"
$html_spectrum.unshift "#a400ff"
$html_spectrum.unshift "#a500ff"
$html_spectrum.unshift "#a600ff"
$html_spectrum.unshift "#a700ff"
$html_spectrum.unshift "#a800ff"
$html_spectrum.unshift "#a900ff"
$html_spectrum.unshift "#aa00ff"
$html_spectrum.unshift "#ab00ff"
$html_spectrum.unshift "#ac00ff"
$html_spectrum.unshift "#ae00ff"
$html_spectrum.unshift "#af00ff"
$html_spectrum.unshift "#b000ff"
$html_spectrum.unshift "#b100ff"
$html_spectrum.unshift "#b200ff"
$html_spectrum.unshift "#b300ff"
$html_spectrum.unshift "#b400ff"
$html_spectrum.unshift "#b500ff"
$html_spectrum.unshift "#b600ff"
$html_spectrum.unshift "#b700ff"
$html_spectrum.unshift "#b800ff"
$html_spectrum.unshift "#b900ff"
$html_spectrum.unshift "#ba00ff"
$html_spectrum.unshift "#bb00ff"
$html_spectrum.unshift "#bc00ff"
$html_spectrum.unshift "#be00ff"
$html_spectrum.unshift "#bf00ff"
$html_spectrum.unshift "#c000ff"
$html_spectrum.unshift "#c100ff"
$html_spectrum.unshift "#c200ff"
$html_spectrum.unshift "#c300ff"
$html_spectrum.unshift "#c400ff"
$html_spectrum.unshift "#c500ff"
$html_spectrum.unshift "#c600ff"
$html_spectrum.unshift "#c700ff"
$html_spectrum.unshift "#c800ff"
$html_spectrum.unshift "#c900ff"
$html_spectrum.unshift "#ca00ff"
$html_spectrum.unshift "#cb00ff"
$html_spectrum.unshift "#cc00ff"
$html_spectrum.unshift "#ce00ff"
$html_spectrum.unshift "#cf00ff"
$html_spectrum.unshift "#e000ff"
$html_spectrum.unshift "#e100ff"
$html_spectrum.unshift "#e200ff"
$html_spectrum.unshift "#e300ff"
$html_spectrum.unshift "#e400ff"
$html_spectrum.unshift "#e500ff"
$html_spectrum.unshift "#e600ff"
$html_spectrum.unshift "#e700ff"
$html_spectrum.unshift "#e800ff"
$html_spectrum.unshift "#e900ff"
$html_spectrum.unshift "#ea00ff"
$html_spectrum.unshift "#eb00ff"
$html_spectrum.unshift "#ec00ff"
$html_spectrum.unshift "#ee00ff"
$html_spectrum.unshift "#ef00ff"
$html_spectrum.unshift "#f000ff"
$html_spectrum.unshift "#f100ff"
$html_spectrum.unshift "#f200ff"
$html_spectrum.unshift "#f300ff"
$html_spectrum.unshift "#f400ff"
$html_spectrum.unshift "#f500ff"
$html_spectrum.unshift "#f600ff"
$html_spectrum.unshift "#f700ff"
$html_spectrum.unshift "#f800ff"
$html_spectrum.unshift "#f900ff"
$html_spectrum.unshift "#fa00ff"
$html_spectrum.unshift "#fb00ff"
$html_spectrum.unshift "#fc00ff"
$html_spectrum.unshift "#fe00ff"
$html_spectrum.unshift "#ff00ff"
